---
import type { CollectionEntry } from 'astro:content';
import BlogPostLayout from '@/features/blog/components/BlogPostLayout.astro';
import { mdxComponents } from '@/components/mdx/components';
import {
  extractBlogSlug,
  getBlogStaticPathsByLang,
  getReadTime,
} from '@/features/blog/server';

const lang = 'zh' as const;

export async function getStaticPaths() {
  return getBlogStaticPathsByLang('zh');
}

type Props = CollectionEntry<'blog'>;

const post = Astro.props as Props;
const { Content } = await post.render();
const currentSlug = extractBlogSlug(post.id, lang);
const readTimeMinutes = getReadTime(post.body, lang);
---

<BlogPostLayout
  {...post.data}
  slug={currentSlug}
  readTimeMinutes={readTimeMinutes}
>
  <Content components={mdxComponents} />
</BlogPostLayout>
