---
import type { CollectionEntry } from 'astro:content';
import BlogPostLayout from '@/features/blog/components/BlogPostLayout.astro';
import {
  extractBlogSlug,
  getBlogStaticPathsByLang,
  getFallbackHeroImage,
  getReadTime,
} from '@/features/blog/server';

const lang = 'zh' as const;

export async function getStaticPaths() {
  return getBlogStaticPathsByLang('zh');
}

type Props = CollectionEntry<'blog'>;

const post = Astro.props as Props;
const { Content } = await post.render();
const currentSlug = extractBlogSlug(post.id, lang);
const readTimeMinutes = getReadTime(post.body, lang);
const fallbackHeroImage = getFallbackHeroImage(post.body);
---

<BlogPostLayout
  {...post.data}
  slug={currentSlug}
  readTimeMinutes={readTimeMinutes}
  fallbackHeroImage={fallbackHeroImage}
>
  <Content />
</BlogPostLayout>
